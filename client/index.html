<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link id="favicon" rel="shortcut icon" type="image/png" href="data:image/png;base64,....==" />
    <meta name="viewport" content="width=device-width">
    <title>Freestyle</title>
    <style>

    /* styles here */

    h1
    {
      background-color:cyan;
      box-shadow:5px 5px 5px black;
      width:200px;
    }
    h2
    {
      background-color: cyan;
      box-shadow: 5px 5px 5px black;
      width:130px;
    }
    

    </style>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <h1>FreeCycle</h1>
  
  <div id="app"> 
  <h2>Create</h2>
        <form @submit.prevent="create_item" data-action="user_id">

          <div class>
          <input v-model="item_user_id" input name="user_id" placeholder="User_id"> <br>
          
          <input v-model="item_lat" input name="lat" placeholder="0"> <br>
         
          <input v-model="item_lon" input name="lon" placeholder="0"> <br>
         
          <input v-model="item_image" input name="image" placeholder="Image"> <br>
         
          <input v-model="item_keywords" input name="keywords" placeholder="Keywords"> <br>
          
          <input v-model="item_description"textarea name="description" placeholder="Description"></textarea> <br>

          <button data-action="create_item" type="submit">Create Item</button> <br>

        </form>
      
        <ul>
          <li v-for="Item in Items">
            <span>{{item_user_id}}</span>
            <span>{{item_lat}}</span>
            <span>{{item_lon}}</span>
            <span>{{item_image}}</span>
            <span>{{item_keywords}}</span>
            <span>{{item_description}}</span>
          </li>
        </ul>
      </div>
    </div>
<script type="module">

  // javascript here
  const { createApp } = Vue
  const DEFAULT_API = '/api/v1';
  const urlParams = new URLSearchParams(window.location.search);
  const urlAPI = (urlParams.get('api') || '/api/v1').replace(/\/$/, '');

  createApp({
      data() {
        return {
          item: {
            id:'',
            user_id:'',
            keywords:'',
            description:'',
            image:'',
            lat:'',
            lon:'',
            date_from:'',
            date_to:'',
          },
          items:[],
        }
      },
      created() {
        this.clear_ITEM()
        this.get_ITEMS()
      },
    methods:{
      // Clears all forms
      clear_ITEM(){
        this.item= { ...this.item, ...{
            user_id:'',
            keywords:'',
            description:'',
            image:'',
            lat:'',
            lon:'',
            
            
        }}
      },
        get_ITEMS() {
         fetch(`${urlAPI}/items`, {
            method: 'GET',
          })
          .then(response => response.json())
          .then(data => this.items=data)
          .catch(err => console.error(err));
        },

        
        createItem() {
         fetch(`${urlAPI}/item`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(this.item),
          })
          .then(response => response.json())
          .then(json => console.log('create_item()', json))
          .then(this.clear_ITEM)
          .then(this.get_ITEMS)
        .catch(err => console.error(err));
        },

        // Deletes items by item's ID
        deleteItem(item_id){
            fetch(`${urlAPI}/item/${item_id}`,{
                method: 'DELETE',
            })
            .then(json => console.log('deleteItem()', json))
            .then(this.get_ITEMS)
              .catch(err => console.error(err));
        }
      },
    }).mount('#app')
      
</script>
</body>
</html>




